module.exports=function(){function t(){for(c=-(this.y>>0),o=c+s,l=0;l<u.length;l++)u[l]()}function r(t,r,n){a={};for(l in r)a[l]=i.map(t,0,1,r[l],n[l]);return a}function n(n){return n.hasOwnProperty("scroller")&&(n.scroller.on("scroll",t),n.scroller.on("scrollEnd",t),document.addEventListener("touchmove",function(t){t.preventDefault()},!1),e=$(n.scroller.scroller),h.resize(function(){for(s=h.height(),o=c+s,l=0;l<p.length;l++)p[l]();t()})),{recalculate:function(){for(s=h.height(),o=c+s,l=0;l<p.length;l++)p[l]()},destroy:function(){d=[],u=[],p=[]},addPiggy:function(t,n){var e,o,l,a,f,w,y=$(t),O=!1,v=0;return d.push(y),n.hasOwnProperty("start")&&n.hasOwnProperty("end")?(n.start.when.indexOf("%")!==-1&&(n.start.when=Number(n.start.when.split("%")[0])/100),n.start.is.indexOf("%")!==-1&&(n.start.is=Number(n.start.is.split("%")[0])/100),n.end.when.indexOf("%")!==-1&&(n.end.when=Number(n.end.when.split("%")[0])/100),n.end.is.indexOf("%")!==-1&&(n.end.is=Number(n.end.is.split("%")[0])/100),p.push(function(){e=y.position().top,o=y.height(),l=e+o*n.start.when,a=e+o*n.end.when}),u.push(function(){l<c+s*n.start.is&&a>c+s*n.end.is&&!O?(n.start.hasOwnProperty("call")&&!O&&n.start.call(),O=!0):(l>c+s*n.start.is||a<=c+s*n.end.is)&&O&&(O=!1,n.end.hasOwnProperty("call")&&n.end.call(),a>c+s*n.end.is?n.hasOwnProperty("scroll")&&(n.start.hasOwnProperty("vals")&&n.end.hasOwnProperty("vals")?n.scroll(n.start.vals):n.scroll({offset:0})):(O=!1,n.hasOwnProperty("scroll")&&(n.start.hasOwnProperty("vals")&&n.end.hasOwnProperty("vals")?n.scroll(n.end.vals):n.scroll({offset:1})))),O&&(f=Math.floor(c+s*n.start.is-l),w=Math.floor(a-(c+s*n.end.is)),v=i.map(f,0,f+w,0,1),n.hasOwnProperty("scroll")&&(n.start.hasOwnProperty("vals")&&n.end.hasOwnProperty("vals")?n.scroll(r(v,n.start.vals,n.end.vals)):n.scroll({offset:v})))}),void h.resize()):void console.warn("Must supply start:{} and end:{} objects. Look at the example in the documentation for details.")}}}var e,s,o,l,a,i={normalize:function(t,r,n){return(t-r)/(n-r)},interpolate:function(t,r,n){return r+(n-r)*t},map:function(t,r,n,e,s){return t<r&&(t=r),t>n&&(t=n),this.interpolate(this.normalize(t,r,n),e,s)}},h=$(window),c=0,d=[],u=[],p=[];return n}();